<form method="post" action="" >
    {% csrf_token %}
    <input hidden value="{{url}}" name="url" id="url" >
    <button type="submit" id="submit" name="submit" class="btn btn-light text-dark me-2" style="font-size:15px; display:none;" ></button>
</form>
<script>
    {% comment %} alert("ok") {% endcomment %}
    window.onload = function() {
        timer()
    }
    var total = 0;
    function timer(){
        new Promise((resolve, reject) => {
            setTimeout(() => {
            console.log("start")                
            resolve();
            }, 10);
        }).then(() => {
            const d1 = new Date();
            while (true) {
                const d2 = new Date();
                if (d2 - d1 > 10*1) {
                    var a = "finish"
                    total =(d2-d1)*0.001
                    console.log("終了！")
                    
                    break;
                }
            }
            
            
            if (a == "finish") {
                new Promise((resolve, reject) => {
                    setTimeout(() => {
                        // 処理内容
                    resolve();
                    }, 1000);
                }).then(() => {
                    document.getElementById("submit").click();
                });
        
            };
        });
    }
</script>